// src/contexts/ThemeContext.js
import React, { createContext, useContext } from 'react';

const ThemeContext = createContext();

export const useTheme = () => {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
};

const theme = {
  colors: {
    primary: '#F4C542',
    secondary: '#4ECDC4',
    background: '#1a1a2e',
    surface: '#16213e',
    text: '#ffffff',
    textSecondary: '#b0b0b0',
    border: '#2d3748',
    borderLight: '#4a5568',
    success: '#16a34a',
    danger: '#dc2626',
    warning: '#f59e0b',
    // üßô‚Äç‚ôÇÔ∏è –ì–ù–û–ú–¨–ò –¶–í–ï–¢–ê
    gnomeGold: '#FFD700',
    gnomeMagic: '#9370DB',
    gnomeHat: '#B22222',
    gnomeBeard: '#F5DEB3',
    gnomeForest: '#228B22'
  },
  // üßô‚Äç‚ôÇÔ∏è –ú–ê–ì–ò–ß–ï–°–ö–ò–ï –≠–§–§–ï–ö–¢–´ –ì–ù–û–ú–û–í
  gnomeEffects: {
    goldGlow: '0 0 20px rgba(255, 215, 0, 0.4), 0 0 40px rgba(255, 215, 0, 0.2)',
    magicGlow: '0 0 20px rgba(147, 112, 219, 0.4), 0 0 40px rgba(147, 112, 219, 0.2)',
    forestGlow: '0 0 15px rgba(34, 139, 34, 0.3)'
  },
  typography: {
    // ‚úÖ –î–û–ë–ê–í–õ–ï–ù –®–†–ò–§–¢ UNBOUNDED
    fontFamily: '"Unbounded", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
    sizes: {
      xs: '12px',
      sm: '14px',
      md: '16px',
      lg: '18px',
      xl: '24px',
      title: '32px'
    },
    weights: {
      light: 300,
      normal: 400,
      medium: 500,
      semibold: 600,
      bold: 700
    }
  },
  spacing: {
    xs: '4px',
    sm: '8px',
    md: '16px',
    lg: '24px',
    xl: '32px',
    xxl: '48px'
  },
  borderRadius: {
    sm: '6px',
    md: '12px',
    lg: '16px',
    xl: '24px'
  },
  shadows: {
    sm: '0 1px 3px rgba(0,0,0,0.12)',
    md: '0 4px 12px rgba(0,0,0,0.15)',
    lg: '0 8px 24px rgba(0,0,0,0.12)'
  },
  animations: {
    duration: {
      fast: '0.15s',
      normal: '0.3s',
      slow: '0.5s'
    },
    easing: {
      default: 'ease',
      bounce: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)'
    }
  },
  zIndex: {
    header: 100,
    modal: 1000,
    tooltip: 1100
  }
};

const styles = {
  heading: {
    fontFamily: theme.typography.fontFamily,
    fontWeight: theme.typography.weights.bold,
    color: theme.colors.text,
    lineHeight: 1.2
  }
};

// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
const createGradientStyle = (colors, direction = '135deg') => ({
  background: `linear-gradient(${direction}, ${colors.join(', ')})`
});

// ‚úÖ –§–£–ù–ö–¶–ò–Ø –ò–ù–ñ–ï–ö–¶–ò–ò –ì–õ–û–ë–ê–õ–¨–ù–´–• –°–¢–ò–õ–ï–ô –° –î–´–ú–ö–û–ô
export const injectGlobalStyles = () => {
  const styleId = 'gnome-global-styles';
  if (document.getElementById(styleId)) return;

  const style = document.createElement('style');
  style.id = styleId;
  style.textContent = `
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
    }

    body {
      font-family: ${theme.typography.fontFamily};
      /* –ó–í–ï–ó–î–ù–´–ô –§–û–ù */
      background:
        radial-gradient(2px 2px at 20px 30px, #fff, transparent),
        radial-gradient(2px 2px at 40px 70px, #fff, transparent),
        radial-gradient(1px 1px at 90px 40px, #fff, transparent),
        radial-gradient(1px 1px at 130px 80px, #fff, transparent),
        radial-gradient(2px 2px at 160px 120px, #fff, transparent),
        radial-gradient(1px 1px at 200px 180px, #fff, transparent),
        radial-gradient(2px 2px at 240px 60px, #fff, transparent),
        radial-gradient(1px 1px at 280px 140px, #fff, transparent),
        radial-gradient(2px 2px at 320px 200px, #fff, transparent),
        radial-gradient(1px 1px at 360px 100px, #fff, transparent),
        /* –ì—Ä–∞–¥–∏–µ–Ω—Ç –∑–≤–µ–∑–¥–Ω–æ–≥–æ –Ω–µ–±–∞ */
        linear-gradient(180deg, #000428 0%, #004e92 100%);
      background-size: 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 400px 300px, 100% 100%;
      background-repeat: repeat, repeat, repeat, repeat, repeat, repeat, repeat, repeat, repeat, repeat, no-repeat;
      background-attachment: fixed;
      color: ${theme.colors.text};
      line-height: 1.6;
      position: relative;
    }

    /* ‚úÖ –î–´–ú–ö–ê –°–ù–ò–ó–£ –í–û –í–°–ï–ú –ü–†–ò–õ–û–ñ–ï–ù–ò–ò - –û–°–ù–û–í–ù–û–ô –°–õ–û–ô */
    body::after {
      content: '';
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40vh; /* 40% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
      background: linear-gradient(
        to top,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(200, 220, 255, 0.12) 15%,
        rgba(180, 200, 255, 0.08) 30%,
        rgba(150, 180, 255, 0.05) 50%,
        rgba(120, 160, 255, 0.03) 70%,
        transparent 100%
      );
      pointer-events: none;
      z-index: 999;
      animation: fogFlow 8s ease-in-out infinite alternate;
    }

    /* ‚úÖ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–´–ú–ö–ê –î–õ–Ø –ì–õ–£–ë–ò–ù–´ - –í–¢–û–†–û–ô –°–õ–û–ô */
    body::before {
      content: '';
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 25vh; /* 25% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
      background: radial-gradient(
        ellipse at center bottom,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(200, 220, 255, 0.06) 20%,
        rgba(180, 200, 255, 0.04) 40%,
        rgba(150, 180, 255, 0.02) 60%,
        transparent 80%
      );
      pointer-events: none;
      z-index: 998;
      animation: fogFlow 12s ease-in-out infinite alternate-reverse;
    }

    /* ‚úÖ –ê–ù–ò–ú–ê–¶–ò–Ø –î–í–ò–ñ–ï–ù–ò–Ø –î–´–ú–ö–ò */
    @keyframes fogFlow {
      0% {
        opacity: 0.6;
        transform: translateY(10px) scaleY(0.95);
      }
      50% {
        opacity: 0.85;
        transform: translateY(0px) scaleY(1.02);
      }
      100% {
        opacity: 0.7;
        transform: translateY(-5px) scaleY(0.98);
      }
    }

    #root {
      min-height: 100vh;
      position: relative;
    }

    /* –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Å–∫—Ä–æ–ª–ª –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ */
    .scroll-container {
      overflow-y: auto;
      height: 100%;
    }

    /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
    .horizontal-scroll {
      overflow-x: auto;
      overflow-y: hidden;
      scrollbar-width: thin;
      scrollbar-color: ${theme.colors.primary} ${theme.colors.border};
    }

    .horizontal-scroll::-webkit-scrollbar {
      height: 8px;
    }

    .horizontal-scroll::-webkit-scrollbar-track {
      background: ${theme.colors.border};
      border-radius: 4px;
    }

    .horizontal-scroll::-webkit-scrollbar-thumb {
      background: ${theme.colors.primary};
      border-radius: 4px;
    }

    .horizontal-scroll::-webkit-scrollbar-thumb:hover {
      background: ${theme.colors.secondary};
    }

    /* –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä—ã –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ */
    .hide-scrollbar {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes pulse {
      0%, 100% {
        opacity: 0.6;
        transform: scale(1);
      }
      50% {
        opacity: 1;
        transform: scale(1.1);
      }
    }

    @keyframes slideInUp {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    /* –ú–µ—Ä—Ü–∞–Ω–∏–µ –∑–≤–µ–∑–¥ */
    @keyframes starTwinkle {
      0%, 100% {
        opacity: 0.8;
      }
      50% {
        opacity: 1;
      }
    }

    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –∑–≤–µ–∑–¥–Ω–æ–º —Ñ–æ–Ω–µ */
    .card-on-stars {
      backdrop-filter: blur(10px);
      background: rgba(22, 33, 62, 0.85) !important;
      border: 1px solid rgba(244, 197, 66, 0.3);
    }

    /* –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∑–≤–µ–∑–¥–Ω–æ–º —Ñ–æ–Ω–µ */
    .text-on-stars {
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }

    /* ‚úÖ –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –î–´–ú–ö–ê –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
    @media (max-width: 768px) {
      body::after {
        height: 35vh; /* –ù–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        background: linear-gradient(
          to top,
          rgba(255, 255, 255, 0.12) 0%,
          rgba(200, 220, 255, 0.08) 15%,
          rgba(180, 200, 255, 0.05) 30%,
          rgba(150, 180, 255, 0.03) 50%,
          transparent 100%
        );
      }
      
      body::before {
        height: 20vh;
        background: radial-gradient(
          ellipse at center bottom,
          rgba(255, 255, 255, 0.08) 0%,
          rgba(200, 220, 255, 0.04) 30%,
          transparent 70%
        );
      }
    }

    /* ‚úÖ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ –î–õ–Ø –û–°–û–ë–û –ú–ê–õ–ï–ù–¨–ö–ò–• –≠–ö–†–ê–ù–û–í */
    @media (max-width: 480px) {
      body::after {
        height: 30vh;
      }
      
      body::before {
        height: 18vh;
      }
    }

    /* Accessibility improvements */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus styles */
    button:focus, 
    [role="button"]:focus {
      outline: 2px solid ${theme.colors.primary};
      outline-offset: 2px;
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
      .card-on-stars {
        border: 2px solid ${theme.colors.primary} !important;
      }
    }

  `;

  document.head.appendChild(style);
};

export const ThemeProvider = ({ children }) => {
  const themeValue = {
    theme,
    styles,
    createGradientStyle
  };

  return (
    <ThemeContext.Provider value={themeValue}>
      {children}
    </ThemeContext.Provider>
  );
};

export default ThemeContext;
